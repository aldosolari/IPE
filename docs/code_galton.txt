#--- GALTON DATA ---

rm(list=ls())

library(readr)
galton <- read_csv("https://dspiegel29.github.io/ArtofStatistics/05-1-sons-fathers-heights/05-1-galton-x.csv")#--- from inches to cmgalton$Father=  galton$Father * 2.54galton$Height=  galton$Height * 2.54attach(galton)#--- unique fathersUnique.Fathers=numeric()nunique=1 # number of unique families Unique.Fathers[1] = Father[1]for(i in 2:length(Family)){     if(Family[i] != Family[i-1]){    nunique=nunique+1    Unique.Fathers[nunique]=Father[i]  }}summary(Unique.Fathers)summary(Father)sd(Unique.Fathers)sd(Father)IQR(Unique.Fathers)IQR(Father)boxplot(list(galton[galton$Gender=="M","Height", drop=T], galton[,"Father", drop=T]), horizontal = T)boxplot(list(galton[galton$Gender=="M","Height", drop=T], Unique.Fathers), horizontal = T)Son = Height[Gender=="M"] FatherS = Father[Gender=="M"]FatherS.j <- jitter(FatherS, factor=5) Son.j <- jitter(Son, factor=5)fit <- lm(Son ~ FatherS) # linear regression data in fitPredicted <- predict(fit)   # Get the predicted valuessummary(fit)xlims=ylims=c(55,80)*2.54plot(Son ~ FatherS, asp=1, xlim=xlims,ylim=ylims)abline(fit)lines(c(xlims[1],xlims[2]),c(xlims[1],xlims[2]),lty=2 )par(mfrow=c(1,1), mar=c(4,4,2,0), pty="s")  # square plotplot(FatherS.j, Son.j, xlim=xlims,ylim=ylims,cex=0.7,     xlab="father's height (inches)",ylab="son's height (inches)" , col="gray68")lines(c(xlims[1],xlims[2]),c(xlims[1],xlims[2]),lty=2 )lines(Predicted~FatherS,lwd=2)